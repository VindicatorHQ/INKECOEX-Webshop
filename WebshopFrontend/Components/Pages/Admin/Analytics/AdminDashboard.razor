@page "/admin"
@using Microsoft.AspNetCore.Authorization
@using WebshopFrontend.Constants
@using WebshopFrontend.Components.Layout
@attribute [Authorize(Roles = "Admin")]

<div class="container mt-5">
    <h1 class="mb-4 text-primary">Admin Dashboard</h1>

    <AdminNav />

    @if (IsLoading)
    {
        <div class="text-center p-5">
            <i class="bi bi-arrow-clockwise h2 text-muted"></i>
            <p>Statistieken worden geladen...</p>
        </div>
    }
    else if (SalesData == null)
    {
        <div class="alert alert-danger">Kon de verkoopstatistieken niet laden. Controleer de API-verbinding.</div>
    }
    else
    {
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2 class="h5">Verkoopstatistieken over de laatste @SelectedDays dagen</h2>
            
            <div class="btn-group" role="group">
                <button class="btn btn-outline-primary @(SelectedDays == 7 ? "active" : "")" @onclick="() => ChangePeriod(7)">7 Dagen</button>
                <button class="btn btn-outline-primary @(SelectedDays == 30 ? "active" : "")" @onclick="() => ChangePeriod(30)">30 Dagen</button>
                <button class="btn btn-outline-primary @(SelectedDays == 90 ? "active" : "")" @onclick="() => ChangePeriod(90)">90 Dagen</button>
            </div>
        </div>

        <div class="row mb-5">
            <div class="col-md-6">
                <div class="card bg-success text-white shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <div class="text-uppercase fw-bold mb-1">Totale Omzet</div>
                                <div class="h3 mb-0">€@SalesData.TotalRevenue</div>
                            </div>
                            <i class="bi bi-currency-euro h1 opacity-50"></i>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card bg-info text-white shadow-sm border-0">
                    <div class="card-body">
                        <div class="d-flex justify-content-between align-items-center">
                            <div>
                                <div class="text-uppercase fw-bold mb-1">Totaal Aantal Orders</div>
                                <div class="h3 mb-0">@SalesData.TotalOrders</div>
                            </div>
                            <i class="bi bi-truck h1 opacity-50"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        @* Grafieken *@
        <div class="row">
            <div class="col-lg-6 mb-4">
                <div class="card shadow">
                    <div class="card-header bg-primary text-white">Omzet per Periode</div>
                    <div class="card-body">
                        @if (SalesData.RevenueByPeriod.Any())
                        {
                            <ChartComponent 
                                Data="SalesData.RevenueByPeriod" 
                                ChartTitle="Omzet (€)" 
                                ChartType="ChartType.Bar"
                                Color="#00d28d"
                            />
                        }
                        else
                        {
                            <p class="text-center text-muted">Geen omzetgegevens beschikbaar in deze periode.</p>
                        }
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mb-4">
                <div class="card shadow">
                    <div class="card-header bg-secondary text-white">Orders per Periode</div>
                    <div class="card-body">
                        @if (SalesData.OrdersByPeriod.Any())
                        {
                            <ChartComponent 
                                Data="SalesData.OrdersByPeriod" 
                                ChartTitle="Orders (#)" 
                                ChartType="ChartType.Line"
                                Color="#6c757d"
                            />
                        }
                        else
                        {
                            <p class="text-center text-muted">Geen ordergegevens beschikbaar in deze periode.</p>
                        }
                    </div>
                </div>
            </div>
        </div>
    }
</div>
