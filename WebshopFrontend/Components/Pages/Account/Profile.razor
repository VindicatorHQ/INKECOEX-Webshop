@using Microsoft.AspNetCore.Authorization
@page "/account/profile"
@attribute [Authorize]

<PageTitle>Mijn Profiel</PageTitle>

<h3>Mijn Profiel</h3>
<hr />

@if (profile == null)
{
    <p><em>Profiel laden...</em></p>
}
else
{
    <EditForm Model="@profile" OnValidSubmit="HandleUpdate">
        <DataAnnotationsValidator />
        
        @if (updateSuccess)
        {
            <div class="alert alert-success mt-3">Profiel succesvol bijgewerkt!</div>
        }
        @if (!string.IsNullOrEmpty(errorMessage))
        {
            <div class="alert alert-danger mt-3">@errorMessage</div>
        }

        @* Sectie 1: Interface Instellingen (Theme) *@
        <div class="card p-3 mb-4 theme-settings-card">
            <h4>Interface Instellingen</h4>
            <hr/>
            <div class="d-flex align-items-center justify-content-between">
                <span>Huidig Thema: <strong>@themeService.CurrentTheme</strong></span>
                <button type="button" class="btn btn-secondary" @onclick="ToggleTheme">
                    <i class="bi bi-gear"></i> Schakel Thema (@(themeService.CurrentTheme == "light" ? "Dark Mode" : "Light Mode"))
                </button>
            </div>
            <small class="text-muted mt-2">Het thema wordt automatisch opgeslagen in uw browser.</small>
        </div>
        
        <div class="row">
            @* Sectie 2: Persoonlijke Gegevens *@
            <div class="col-md-6">
                <div class="card p-3 mb-4">
                    <h4>Persoonlijke Gegevens</h4>
                    <hr/>
                    <div class="mb-3">
                        <label class="form-label">E-mail (niet wijzigbaar)</label>
                        <InputText class="form-control" @bind-Value="profile.Email" disabled />
                    </div>
                    <div class="mb-3">
                        <label for="firstname" class="form-label">Voornaam</label>
                        <InputText id="firstname" class="form-control" @bind-Value="profile.FirstName" />
                    </div>
                    <div class="mb-3">
                        <label for="lastname" class="form-label">Achternaam</label>
                        <InputText id="lastname" class="form-control" @bind-Value="profile.LastName" />
                    </div>
                </div>
            </div>

            @* Sectie 3: Adres Gegevens *@
            <div class="col-md-6">
                <div class="card p-3 mb-4">
                    <h4>Verzendadres (Standaard voor Checkout)</h4>
                    <hr/>
                    <div class="mb-3">
                        <label for="street" class="form-label">Straat</label>
                        <InputText id="street" class="form-control" @bind-Value="profile.Street" />
                    </div>
                    <div class="mb-3">
                        <label for="postalcode" class="form-label">Postcode</label>
                        <InputText id="postalcode" class="form-control" @bind-Value="profile.PostalCode" />
                    </div>
                    <div class="mb-3">
                        <label for="city" class="form-label">Plaats</label>
                        <InputText id="city" class="form-control" @bind-Value="profile.City" />
                    </div>
                    <div class="mb-3">
                        <label for="country" class="form-label">Land</label>
                        <InputText id="country" class="form-control" @bind-Value="profile.Country" />
                    </div>
                </div>
            </div>
        </div>

        <button type="submit" class="btn btn-success btn-lg mt-3">
            <i class="bi bi-save"></i> Profiel Opslaan
        </button>
    </EditForm>
}
