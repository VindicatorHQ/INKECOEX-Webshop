@using WebshopFrontend.Agents.Interface
@inject ICategoryAgent CategoryAgent

<h3>@Title</h3>

@if (categories == null)
{
    <p><em>Categorieën laden...</em></p>
}
else
{
    <EditForm Model="@ProductRequest" OnValidSubmit="OnValidSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="mb-3">
            <label for="name" class="form-label">Naam</label>
            <InputText id="name" class="form-control" @bind-Value="ProductRequest.Name" />
        </div>
        
        <div class="mb-3">
            <label for="description" class="form-label">Beschrijving</label>
            <InputTextArea id="description" class="form-control" @bind-Value="ProductRequest.Description" />
        </div>

        <div class="mb-3">
            <label for="price" class="form-label">Prijs</label>
            <InputNumber id="price" class="form-control" @bind-Value="ProductRequest.Price" />
        </div>
        
        <div class="mb-3">
            <label for="stock" class="form-label">Voorraad</label>
            <InputNumber id="stock" class="form-control" @bind-Value="ProductRequest.StockQuantity" />
        </div>
        
        <div class="mb-3">
            <label class="form-label">Categorieën</label>
            @foreach (var category in categories)
            {
                <div class="form-check">
                    <input type="checkbox" 
                           class="form-check-input" 
                           id="@($"cat-{category.Id}")" 
                           checked="@ProductRequest.CategoryIds.Contains(category.Id)"
                           @onchange="() => ToggleCategory(category.Id)" />
                    <label class="form-check-label" for="@($"cat-{category.Id}")">@category.Name</label>
                </div>
            }
        </div>

        <button type="submit" class="btn btn-primary">@ButtonText</button>
    </EditForm>
}